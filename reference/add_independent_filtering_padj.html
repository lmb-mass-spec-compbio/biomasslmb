<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform independent filtering to threshold the over-representation testing on the number of features in each category to limit the multiple testing burden — add_independent_filtering_padj • biomasslmb</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform independent filtering to threshold the over-representation testing on the number of features in each category to limit the multiple testing burden — add_independent_filtering_padj"><meta name="description" content="When testing for enrichment of feature annotations, we frequently test
thousands of annotations simultaneously, which increases the multiple testing burden considerably.
Given many annotations have very few annotated features, there will be too little power to detect
over-representation. Inspired by DESeq2, which was in turn inspired by Bourgon, Gentleman, and Huber (2010),
this function applies the principle of 'independent filtering' to threshold the minimum
number of features per annotation (in the background) to optimally limit the multiple testing burden. This is
statistically valid because the filtering criteria (number of features per annotation) is
statistically independent from the test statistic under the null hypothesis.
The independent filtering works because the filtering criteria is correlated
with the test statistic under the alternative hypothesis. For further justification and discussion of independent filtering,
see Bourgon, Gentleman, and Huber (2010) and
the DESeq2 vignette.
The code function is largely lifted from DEseq:::pvalueAdjustment
Please cite Bourgon, Gentleman, and Huber (2010) when using this function."><meta property="og:description" content="When testing for enrichment of feature annotations, we frequently test
thousands of annotations simultaneously, which increases the multiple testing burden considerably.
Given many annotations have very few annotated features, there will be too little power to detect
over-representation. Inspired by DESeq2, which was in turn inspired by Bourgon, Gentleman, and Huber (2010),
this function applies the principle of 'independent filtering' to threshold the minimum
number of features per annotation (in the background) to optimally limit the multiple testing burden. This is
statistically valid because the filtering criteria (number of features per annotation) is
statistically independent from the test statistic under the null hypothesis.
The independent filtering works because the filtering criteria is correlated
with the test statistic under the alternative hypothesis. For further justification and discussion of independent filtering,
see Bourgon, Gentleman, and Huber (2010) and
the DESeq2 vignette.
The code function is largely lifted from DEseq:::pvalueAdjustment
Please cite Bourgon, Gentleman, and Huber (2010) when using this function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biomasslmb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/LFQ_DDA_Peptide_QC_Summarisation.html">LFQ-DDA QC Peptide-level quantification and summarisation to protein-level abundance</a></li>
    <li><a class="dropdown-item" href="../articles/LFQ_DIA_Peptide_QC.html">LFQ-DIA QC Peptide-level quantification and summarisation to protein-level abundance</a></li>
    <li><a class="dropdown-item" href="../articles/TMT_PSM_QC_Summarisation.html">TMT QC PSM-level quantification and summarisation to protein-level abundance</a></li>
    <li><a class="dropdown-item" href="../articles/TMT_summarisation_methods.html">TMT - comparing protein summarisation approaches</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform independent filtering to threshold the over-representation testing on the number of features in each category to limit the multiple testing burden</h1>

      <div class="d-none name"><code>add_independent_filtering_padj.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When testing for enrichment of feature annotations, we frequently test
thousands of annotations simultaneously, which increases the multiple testing burden considerably.
Given many annotations have very few annotated features, there will be too little power to detect
over-representation. Inspired by DESeq2, which was in turn inspired by <a href="https://www.pnas.org/doi/10.1073/pnas.0914005107" class="external-link">Bourgon, Gentleman, and Huber (2010)</a>,
this function applies the principle of 'independent filtering' to threshold the minimum
number of features per annotation (in the background) to optimally limit the multiple testing burden. This is
statistically valid because the filtering criteria (number of features per annotation) is
statistically independent from the test statistic under the null hypothesis.
The independent filtering works because the filtering criteria is correlated
with the test statistic under the alternative hypothesis. For further justification and discussion of independent filtering,
see <a href="https://www.pnas.org/doi/10.1073/pnas.0914005107" class="external-link">Bourgon, Gentleman, and Huber (2010)</a> and
the <a href="https://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#indfilttheory" class="external-link">DESeq2 vignette</a>.</p>
<p>The code function is largely lifted from <code>DEseq:::pvalueAdjustment</code></p>
<p>Please cite <a href="https://www.pnas.org/doi/10.1073/pnas.0914005107" class="external-link">Bourgon, Gentleman, and Huber (2010)</a> when using this function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_independent_filtering_padj</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  p_value_col <span class="op">=</span> <span class="st">"over_represented_pvalue"</span>,</span>
<span>  filter_col <span class="op">=</span> <span class="st">"numInCat"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p><code>data.frame</code> containing <code>goseq</code> results as generated by
<code><a href="get_enriched_go.html">get_enriched_go</a></code>
See below for an example.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p><code>numeric</code> alpha value to use for rejection of null hypothesis.
Note this is only used for optimising the threshold and any alternative value for alpha can be used downstream</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p><code>numeric</code> vector of thresholds (fractions of the data to remove)</p></dd>


<dt id="arg-p-value-col">p_value_col<a class="anchor" aria-label="anchor" href="#arg-p-value-col"></a></dt>
<dd><p><code>character</code> Column with p-values</p></dd>


<dt id="arg-filter-col">filter_col<a class="anchor" aria-label="anchor" href="#arg-filter-col"></a></dt>
<dd><p><code>character</code> Column with filtering criteria values</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><code>logical</code> Plot the relationship between the</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns the <code>data.frame</code> with an added column denoting the optimised adjusted p-value ('padj_if')</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tom Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

