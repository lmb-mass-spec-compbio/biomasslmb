<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>TMT - comparing protein summarisation approaches • biomasslmb</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TMT - comparing protein summarisation approaches">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biomasslmb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/LFQ_DDA_Peptide_QC_Summarisation.html">LFQ-DDA QC Peptide-level quantification and summarisation to protein-level abundance</a></li>
    <li><a class="dropdown-item" href="../articles/LFQ_DIA_Peptide_QC.html">LFQ-DIA QC Peptide-level quantification and summarisation to protein-level abundance</a></li>
    <li><a class="dropdown-item" href="../articles/TMT_PSM_QC_Summarisation.html">TMT QC PSM-level quantification and summarisation to protein-level abundance</a></li>
    <li><a class="dropdown-item" href="../articles/TMT_summarisation_methods.html">TMT - comparing protein summarisation approaches</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>TMT - comparing protein summarisation approaches</h1>
                        <h4 data-toc-skip class="author">Tom Smith</h4>
            
            <h4 data-toc-skip class="date">2025-07-07</h4>
      

      <div class="d-none name"><code>TMT_summarisation_methods.Rmd</code></div>
    </div>

    
    
<p>Here, we will consider different protein summarisation approaches for
TMT data, depending on whether missing values need to be retained. The
comparison between summarisation approaches is also informative when
considering what it means to summarise from PSMs to protein-level
abundances.</p>
<p>For PSM to protein summarisation with TMT quantification, simply
summing together the PSM-level abundances provides accurate estimates,
so long as there are no missing values. If many missing values are
present, the <code><a href="https://rdrr.io/pkg/MsCoreUtils/man/robustSummary.html" class="external-link">MsCoreUtils::robustSummary</a></code> method may be
preferred, since it is able to summarise accurately, even in the
presence of missing values <span class="citation">(Sticker et al.
2020)</span>.</p>
<div class="section level2">
<h2 id="load-required-packages">Load required packages<a class="anchor" aria-label="anchor" href="#load-required-packages"></a>
</h2>
<p>To clarify which functionality is provided by which package, we will
use <code>package::function</code>. For your own code, there is no need
to specify the package unless you want to maintain this clarity.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lmb-mass-spec-compbio.github.io/biomasslmb/">biomasslmb</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p><code>tmt_qf</code> is a <code>QFeatures</code> object available from
the <code>biomasslmb</code> package which was generated in the
<code>TMT QC PSM-level quantification and summarisation to protein-level abundance</code>
vignette. It already contains protein-level quantification from a simple
‘sum’ summarisation, where missing values were removed and proteins with
a single PSM were removed. Here, we will compare this with the ‘robust’
summaristion, which requires some additional steps to ensure it is
performed appropriately.</p>
<div class="section level3">
<h3 id="summarisation-with-robustsummary">Summarisation with robustSummary<a class="anchor" aria-label="anchor" href="#summarisation-with-robustsummary"></a>
</h3>
<p>With <code>robustSummary</code>, we do not need to remove all PSMs
with missing values since the summarisation algorithm deals with them
appropriately. However, we still don’t want to retain PSMs with too many
missing values, since these will not be very informative in estimating
the protein-level quantification. Here, we will retain PSMs with at most
5/10 missing values</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_forRobust'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterNA</a></span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_rank'</span><span class="op">]</span><span class="op">]</span>, <span class="fl">5</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Next, we remove PSMs for proteins with fewer than 2 PSMs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">min_psms</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span> </span>
<span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_forRobust'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">biomasslmb</span><span class="fu">::</span><span class="fu"><a href="../reference/filter_features_per_protein.html">filter_features_per_protein</a></span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_forRobust'</span><span class="op">]</span><span class="op">]</span>, min_features <span class="op">=</span> <span class="va">min_psms</span><span class="op">)</span></span></code></pre></div>
<p>For the <code>robustSummary</code> summarisation, we need our
quantification values to be approximately Gaussian distributed. Hence,
we log transform them.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_forRobust'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-processing.html" class="external-link">logTransform</a></span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_forRobust'</span><span class="op">]</span><span class="op">]</span>, base<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Now we can summarise with <code>robustSummary</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate to protein-level abundances (using QFeatures function)</span></span>
<span><span class="va">tmt_qf</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a></span><span class="op">(</span><span class="va">tmt_qf</span>, </span>
<span>                                       i <span class="op">=</span> <span class="st">"psms_filtered_forRobust"</span>, </span>
<span>                                       fcol <span class="op">=</span> <span class="st">"Master.Protein.Accessions"</span>,</span>
<span>                                       name <span class="op">=</span> <span class="st">"protein_robust"</span>,</span>
<span>                                       fun <span class="op">=</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MsCoreUtils/man/robustSummary.html" class="external-link">robustSummary</a></span>,</span>
<span>                                       maxit<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Your quantitative data contain missing values. Please read the relevant</span></span>
<span><span class="co">#&gt; section(s) in the aggregateFeatures manual page regarding the effects</span></span>
<span><span class="co">#&gt; of missing values on data aggregation.</span></span></code></pre></div>
<p>Prior to summaristaion, we removed PSMs from proteins with fewer than
2 PSMs. However, since we left in PSMs with missing values, it’s
possible for some protein-level abundances to be derived from just a
single PSM. We can use the <code>get_protein_no_quant_mask</code> from
<code>biomasslmb</code> to identify where the protein abundances will be
derived from fewer than <code>n</code> features (PSMs). We can then give
this mask to <code>mask_protein_level_quant</code> to replace these
quantification values with NA.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot = TRUE means we will also get a plot of the number of proteins quantified in each sample</span></span>
<span><span class="va">protein_retain_mask</span> <span class="op">&lt;-</span> <span class="fu">biomasslmb</span><span class="fu">::</span><span class="fu"><a href="../reference/get_protein_no_quant_mask.html">get_protein_no_quant_mask</a></span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_forRobust'</span><span class="op">]</span><span class="op">]</span>, min_features<span class="op">=</span><span class="fl">2</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="TMT_summarisation_methods_files/figure-html/unnamed-chunk-6-1.png" width="50%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_robust'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">biomasslmb</span><span class="fu">::</span><span class="fu"><a href="../reference/mask_protein_level_quant.html">mask_protein_level_quant</a></span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_robust'</span><span class="op">]</span><span class="op">]</span>, <span class="va">protein_retain_mask</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarisation-with-median-or-mean">Summarisation with median or mean<a class="anchor" aria-label="anchor" href="#summarisation-with-median-or-mean"></a>
</h3>
<p>We will also include summarisation with mean and median, since these
are typical approaches for summarising across observations and will aid
the interpretation when we compare the summasiation approaches. We will
use the PSMs with missing values filtered, even though <code>mean</code>
and <code>median</code> can handle missing values with
<code>na.rm=TRUE</code>, since ignoring missing values is inappropriate
for summarisation of PSMs to proteins with these methods.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tmt_qf</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a></span><span class="op">(</span><span class="va">tmt_qf</span>, </span>
<span>                                       i <span class="op">=</span> <span class="st">"psms_filtered_forSum"</span>, </span>
<span>                                       fcol <span class="op">=</span> <span class="st">"Master.Protein.Accessions"</span>,</span>
<span>                                       name <span class="op">=</span> <span class="st">"protein_mean"</span>,</span>
<span>                                       fun <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmt_qf</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a></span><span class="op">(</span><span class="va">tmt_qf</span>, </span>
<span>                                       i <span class="op">=</span> <span class="st">"psms_filtered_forSum"</span>, </span>
<span>                                       fcol <span class="op">=</span> <span class="st">"Master.Protein.Accessions"</span>,</span>
<span>                                       name <span class="op">=</span> <span class="st">"protein_median"</span>,</span>
<span>                                       fun <span class="op">=</span> <span class="fu">matrixStats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/matrixStats/man/rowMedians.html" class="external-link">colMedians</a></span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_mean'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-processing.html" class="external-link">logTransform</a></span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_mean'</span><span class="op">]</span><span class="op">]</span>, base<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_median'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-processing.html" class="external-link">logTransform</a></span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_median'</span><span class="op">]</span><span class="op">]</span>, base<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-the-summarisation-approaches">Comparing the summarisation approaches<a class="anchor" aria-label="anchor" href="#comparing-the-summarisation-approaches"></a>
</h3>
<p>We can see that performing the robust summarisation allows us to
retain more proteins, since we can still use the PSMs with a low number
of missing values.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 891</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_robust'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 921</span></span></code></pre></div>
<p>However, with sum summarisation, we have complete quantification data
(no missing values), whereas with <code>robustSummary</code>, we will
proteins with missing values in some samples. In this case, the
protein-level data is 99.48 % complete, so the impact of the missing
values on the downstream analysis will be minimal. We can inspect
missing values using the <code><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">QFeatures::nNA</a></code> function, or just
<code>is.na</code> on the quantitative data matrix.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">nNA</a></span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">nNAcols</span></span>
<span><span class="co">#&gt; DataFrame with 10 rows and 3 columns</span></span>
<span><span class="co">#&gt;             name       nNA       pNA</span></span>
<span><span class="co">#&gt;      &lt;character&gt; &lt;integer&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt; 1  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 2  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 3  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 4  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 5  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 6  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 7  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 8  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 9  Abundance....         0         0</span></span>
<span><span class="co">#&gt; 10 Abundance....         0         0</span></span>
<span><span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">nNA</a></span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_robust'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">nNAcols</span></span>
<span><span class="co">#&gt; DataFrame with 10 rows and 3 columns</span></span>
<span><span class="co">#&gt;             name       nNA        pNA</span></span>
<span><span class="co">#&gt;      &lt;character&gt; &lt;integer&gt;  &lt;numeric&gt;</span></span>
<span><span class="co">#&gt; 1  Abundance....         0 0.00000000</span></span>
<span><span class="co">#&gt; 2  Abundance....         0 0.00000000</span></span>
<span><span class="co">#&gt; 3  Abundance....         1 0.00108578</span></span>
<span><span class="co">#&gt; 4  Abundance....         5 0.00542888</span></span>
<span><span class="co">#&gt; 5  Abundance....         2 0.00217155</span></span>
<span><span class="co">#&gt; 6  Abundance....         5 0.00542888</span></span>
<span><span class="co">#&gt; 7  Abundance....         2 0.00217155</span></span>
<span><span class="co">#&gt; 8  Abundance....         7 0.00760043</span></span>
<span><span class="co">#&gt; 9  Abundance....        11 0.01194354</span></span>
<span><span class="co">#&gt; 10 Abundance....        15 0.01628664</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'%.2f %% missing values'</span>, <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_robust'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.52 % missing values</span></span></code></pre></div>
<p>To better understand the difference between how the two summarisation
methods use the available data, we can inspect the single protein which
has no missing values with <code>robustSummary</code>, but is not
summarised with <code>sum</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify the proteins with no missing values present only following robustSummary</span></span>
<span><span class="va">protein_robust_proteins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_robust'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">protein_sum_proteins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">no_missing_robustSummary_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">protein_robust_proteins</span>, <span class="va">protein_sum_proteins</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">no_missing_robustSummary_only</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "P22695"</span></span></code></pre></div>
<p>If we inspect the PSM level abundances for this protein, we see that
there are 3 PSMs, of which the first two contain missing values in a
single sample. Thus, we have only one complete PSM, which is
insufficient for confident summarisation using <code>sum</code>.
However, all 3 PSMs have sufficiently few missing values to be used with
the <code>robustSummary</code> method and all samples have at least two
non missing values across the 3 PSMs, so this protein is quantified in
all samples with <code>robustSummary</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">retain_psms</span> <span class="op">&lt;-</span> <span class="fu">rowData</span><span class="op">(</span></span>
<span>  <span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_sn'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">Master.Protein.Accessions</span><span class="op">==</span><span class="va">no_missing_robustSummary_only</span></span>
<span></span>
<span><span class="fu">assay</span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'psms_filtered_sn'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">retain_psms</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Abundance.126 Abundance.127N Abundance.127C Abundance.128N Abundance.128C</span></span>
<span><span class="co">#&gt; 517      114.68442       158.3876       286.2073       438.4889       173.5508</span></span>
<span><span class="co">#&gt; 1686     587.11851       412.4273       322.2673       232.8183      1419.0267</span></span>
<span><span class="co">#&gt; 3597      89.15436       134.6058       212.5193       336.5223       139.6542</span></span>
<span><span class="co">#&gt;      Abundance.129N Abundance.129C Abundance.130N Abundance.130C Abundance.131</span></span>
<span><span class="co">#&gt; 517        41.27858       15.23801       10.07546             NA            NA</span></span>
<span><span class="co">#&gt; 1686      494.28845             NA       23.85513      33.802622     58.042540</span></span>
<span><span class="co">#&gt; 3597       31.63687       24.65788       17.03938       4.101573      8.346825</span></span></code></pre></div>
<p>We can directly compare the protein-level abundance estimates to
explore where these two summarisation methods differ in their
estimates.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a function to extract the protein abundances in long form and</span></span>
<span><span class="co"># add a column annotating the method</span></span>
<span><span class="va">get_long_form_prot_exp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obj</span>, <span class="va">method_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">assay</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">'protein'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="op">-</span><span class="va">protein</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">method_name</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Single object with protein inference from both methods </span></span>
<span><span class="va">compare_protein_abundances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">longFormat</span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, method<span class="op">=</span><span class="st">'Sum'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">longFormat</span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_robust'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, method<span class="op">=</span><span class="st">'Robust'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">longFormat</span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_median'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, method<span class="op">=</span><span class="st">'Median'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">longFormat</span><span class="op">(</span><span class="va">tmt_qf</span><span class="op">[[</span><span class="st">'protein_mean'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, method<span class="op">=</span><span class="st">'Mean'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">compare_protein_abundances</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rowname       colname     value method</span></span>
<span><span class="co">#&gt; 1  A1L0T0 Abundance.126  8.340996    Sum</span></span>
<span><span class="co">#&gt; 2  A4D1E9 Abundance.126  9.674770    Sum</span></span>
<span><span class="co">#&gt; 3  A6NHR9 Abundance.126 10.319013    Sum</span></span>
<span><span class="co">#&gt; 4  O00116 Abundance.126  6.884527    Sum</span></span>
<span><span class="co">#&gt; 5  O00154 Abundance.126  5.597842    Sum</span></span>
<span><span class="co">#&gt; 6  O00159 Abundance.126 10.410898    Sum</span></span></code></pre></div>
<p>We want to identify the proteins with the lowest correlation for
abundances across the samples between summarisation methods so we can
inspect the difference between them.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proteins_of_interest</span> <span class="op">&lt;-</span> <span class="va">compare_protein_abundances</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">method</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">rowname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>cor_sum_median<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Sum</span>, <span class="va">Median</span><span class="op">)</span>,</span>
<span>            cor_sum_robust<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Sum</span>, <span class="va">Robust</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="op">-</span><span class="va">rowname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">rowname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>min_cor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">min_cor</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">rowname</span><span class="op">)</span></span></code></pre></div>
<p>Below, we define a function to plot the PSM and protein level
abundances for a single protein.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_pep_and_protein</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">protein_of_interest</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">to_plot_compare</span> <span class="op">&lt;-</span> <span class="va">compare_protein_abundances</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rowname</span> <span class="op">==</span> <span class="va">protein_of_interest</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/filterFeatures.html" class="external-link">filterFeatures</a></span><span class="op">(</span></span>
<span>    <span class="va">tmt_qf</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-filtering.html" class="external-link">VariableFilter</a></span><span class="op">(</span><span class="st">"Master.Protein.Accessions"</span>,</span>
<span>                   <span class="va">protein_of_interest</span>,</span>
<span>                   condition <span class="op">=</span> <span class="st">"=="</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">'psms_filtered_sn'</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">longFormat</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">colname</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">rowname</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">to_plot_compare</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">colname</span>, y <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">method</span>, group <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">#geom_point(data = to_plot_compare,  position=position_dodge(width=0.5),</span></span>
<span>    <span class="co">#           aes(x = colname, y = value, colour = method)) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="../reference/get_cat_palette.html">get_cat_palette</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>                        name <span class="op">=</span> <span class="st">'Protein summarisation method'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/theme_biomasslmb.html">theme_biomasslmb</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span>, border <span class="op">=</span> <span class="cn">FALSE</span>, base_family <span class="op">=</span> <span class="st">'sans'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="va">protein_of_interest</span>,</span>
<span>      x <span class="op">=</span> <span class="st">''</span>,</span>
<span>      y <span class="op">=</span> <span class="st">'PSM/Protein abundance (log2)'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In the plots below, PSM level quantifications are in grey and the
summarised protein-level abundances are in colours. You can disregard
the y-axis scale when comparing between the methods, or between the
protein and peptide level abundances. The important thing to focus on is
the abundance profile between the tags for any one summarisation method
or PSM.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">poi</span> <span class="kw">in</span> <span class="va">proteins_of_interest</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">plot_pep_and_protein</span><span class="op">(</span><span class="va">poi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="TMT_summarisation_methods_files/figure-html/unnamed-chunk-15-1.png" width="45%"><img src="TMT_summarisation_methods_files/figure-html/unnamed-chunk-15-2.png" width="45%"><img src="TMT_summarisation_methods_files/figure-html/unnamed-chunk-15-3.png" width="45%"><img src="TMT_summarisation_methods_files/figure-html/unnamed-chunk-15-4.png" width="45%"><img src="TMT_summarisation_methods_files/figure-html/unnamed-chunk-15-5.png" width="45%"></p>
<p>In all cases, the protein-level quantification values are relatively
similar for most tags, the differences between the approach typically
restricted to one or two tags where the PSMs disagree on the relative
abundances between the samples.</p>
<p>Since <code>sum</code> simply adds together the abundance values
across the PSMs for a given tag and the abundance values may be across
multiple orders of magnitude, the protein-level abundance pattern across
the tags is weighted towards the most abundant PSMs. This is likely to
be a positive attribute, since the most abundant PSMs will be more
accurately quantified. However, the summarisation is also sensitive to
high abundance outliers.</p>
<p>On the other hand, <code>robustSummary</code> is less sensitive to
outliers, but it treats all PSMs equally. In the forth example (Q9NUQ9)
we can see how this can lead to potential inaccuracies when we have only
2 PSMs and one is very low intensity. For example, tag 129C is mid-range
intensity compared to the other tags for the abundant PSM, but very low
for the less abundant PSM. This has almost no impact on the
<code>sum</code> summarise protein abundance, but a large impact when we
use <code>robustSummary</code>.</p>
<p>Note that mean is identical to sum with respect to the relative
abundance across the samples, just on a difference scale, since mean is
sum/n(PSMs).</p>
<p>The median is less sensitive to outliers than the mean, but ignores
much of the quantitative data since it’s only affected by the ‘middle’
PSMs. In the most extreme instances, median just simplifies the PSM
level abundances down to a single representative ‘middle’ PSM.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p><code>sum</code>/<code>mean</code> are more sensitive to the
abundances for the highest intensity PSMs, which are likely to be the
most accurately quantified. However, they are therefore also more
sensitive to outlier values with very high abundance.
<code>robustSummary</code> handles missing values and therefore enables
more proteins to be quantified but it is more sensitive to low intensity
PSMs, which may be less accurately quantified. For typical TMT datasets
with very low missing values, <code>sum</code>/<code>mean</code> are
likely to be the best approach. Where there are more missing values,
consider using <code>robust</code> instead.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] dplyr_1.1.4                 tidyr_1.3.1                </span></span>
<span><span class="co">#&gt;  [3] ggplot2_3.5.2               biomasslmb_0.0.3           </span></span>
<span><span class="co">#&gt;  [5] QFeatures_1.18.0            MultiAssayExperiment_1.34.0</span></span>
<span><span class="co">#&gt;  [7] SummarizedExperiment_1.38.1 Biobase_2.68.0             </span></span>
<span><span class="co">#&gt;  [9] GenomicRanges_1.60.0        GenomeInfoDb_1.44.0        </span></span>
<span><span class="co">#&gt; [11] IRanges_2.42.0              S4Vectors_0.46.0           </span></span>
<span><span class="co">#&gt; [13] BiocGenerics_0.54.0         generics_0.1.4             </span></span>
<span><span class="co">#&gt; [15] MatrixGenerics_1.20.0       matrixStats_1.5.0          </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyselect_1.2.1        farver_2.1.2            blob_1.2.4             </span></span>
<span><span class="co">#&gt;  [4] Biostrings_2.76.0       fastmap_1.2.0           lazyeval_0.2.2         </span></span>
<span><span class="co">#&gt;  [7] XML_3.99-0.18           digest_0.6.37           lifecycle_1.0.4        </span></span>
<span><span class="co">#&gt; [10] cluster_2.1.8.1         ProtGenerics_1.40.0     survival_3.8-3         </span></span>
<span><span class="co">#&gt; [13] KEGGREST_1.48.1         RSQLite_2.4.1           magrittr_2.0.3         </span></span>
<span><span class="co">#&gt; [16] genefilter_1.90.0       compiler_4.5.1          rlang_1.1.6            </span></span>
<span><span class="co">#&gt; [19] sass_0.4.10             tools_4.5.1             igraph_2.1.4           </span></span>
<span><span class="co">#&gt; [22] yaml_2.3.10             corrplot_0.95           knitr_1.50             </span></span>
<span><span class="co">#&gt; [25] labeling_0.4.3          S4Arrays_1.8.1          htmlwidgets_1.6.4      </span></span>
<span><span class="co">#&gt; [28] bit_4.6.0               DelayedArray_0.34.1     plyr_1.8.9             </span></span>
<span><span class="co">#&gt; [31] RColorBrewer_1.1-3      abind_1.4-8             withr_3.0.2            </span></span>
<span><span class="co">#&gt; [34] purrr_1.0.4             desc_1.4.3              grid_4.5.1             </span></span>
<span><span class="co">#&gt; [37] xtable_1.8-4            scales_1.4.0            MASS_7.3-65            </span></span>
<span><span class="co">#&gt; [40] cli_3.6.5               rmarkdown_2.29          crayon_1.5.3           </span></span>
<span><span class="co">#&gt; [43] ragg_1.4.0              robustbase_0.99-4-1     httr_1.4.7             </span></span>
<span><span class="co">#&gt; [46] reshape2_1.4.4          BiocBaseUtils_1.10.0    DBI_1.2.3              </span></span>
<span><span class="co">#&gt; [49] cachem_1.1.0            stringr_1.5.1           splines_4.5.1          </span></span>
<span><span class="co">#&gt; [52] AnnotationDbi_1.70.0    AnnotationFilter_1.32.0 XVector_0.48.0         </span></span>
<span><span class="co">#&gt; [55] vctrs_0.6.5             Matrix_1.7-3            jsonlite_2.0.0         </span></span>
<span><span class="co">#&gt; [58] naniar_1.1.0            visdat_0.6.0            bit64_4.6.0-1          </span></span>
<span><span class="co">#&gt; [61] clue_0.3-66             systemfonts_1.2.3       jquerylib_0.1.4        </span></span>
<span><span class="co">#&gt; [64] annotate_1.86.1         glue_1.8.0              DEoptimR_1.1-3-1       </span></span>
<span><span class="co">#&gt; [67] pkgdown_2.1.3           uniprotREST_1.0.0       stringi_1.8.7          </span></span>
<span><span class="co">#&gt; [70] gtable_0.3.6            UCSC.utils_1.4.0        tibble_3.3.0           </span></span>
<span><span class="co">#&gt; [73] pillar_1.11.0           htmltools_0.5.8.1       GenomeInfoDbData_1.2.14</span></span>
<span><span class="co">#&gt; [76] R6_2.6.1                textshaping_1.0.1       evaluate_1.0.4         </span></span>
<span><span class="co">#&gt; [79] lattice_0.22-7          backports_1.5.0         png_0.1-8              </span></span>
<span><span class="co">#&gt; [82] memoise_2.0.1           bslib_0.9.0             Rcpp_1.1.0             </span></span>
<span><span class="co">#&gt; [85] checkmate_2.3.2         SparseArray_1.8.0       xfun_0.52              </span></span>
<span><span class="co">#&gt; [88] MsCoreUtils_1.20.0      fs_1.6.6                pkgconfig_2.0.3</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-http://zotero.org/users/5634351/items/FZN3QTTZ" class="csl-entry">
Sticker, Adriaan, Ludger Goeminne, Lennart Martens, and Lieven Clement.
2020. <span>“Robust Summarization and Inference in Proteome-wide
Label-free Quantification.”</span> <em>Molecular &amp; cellular
proteomics: MCP</em> 19 (7): 1209–19. <a href="https://doi.org/10.1074/mcp.RA119.001624" class="external-link">https://doi.org/10.1074/mcp.RA119.001624</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tom Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
